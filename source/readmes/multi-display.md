# FPGA, UART 통신을 활용한 다기능 디스플레이 모듈 개발

2025.03.27 ~ 2025.03.30 (4人 팀 프로젝트)


## 요약

Verilog HDL을 기반으로 STOP WATCH, CLOCK, 초음파 센서(HC-SR04), 온습도 센서(DHT11)의 기능을 설계하고, UART 및 버튼 입력으로 제어 가능한 디스플레이 모듈을 개발함. 각각의 기능은 독립적으로 동작하면서 UART 명령어에 따라 통합 제어되어 전체 시스템이 유기적으로 동작하도록 구성함.

- STOP WATCH, 시계 모드의 시간 측정 및 디스플레이 기능 구현

- 초음파 센서를 통한 거리 측정 기능 구성 (Auto Run 및 필터 적용)

- 온습도 센서를 통한 환경 데이터 수집 및 UART 전송

- UART + 버튼 입력을 통해 모든 기능을 통합 제어


## 역할

- 초음파 센서 FSM 및 Median Filter 설계

- DHT11 온습도 센서 FSM 설계 및 자동 주기 측정 FSM 추가

- UART 기반 명령 처리 로직 작성 및 버튼/센서 동작 연동

- Vivado 환경에서 Simulation 및 실제 테스트 수행

## 트러블 슈팅

### [1] 초음파 센서 오류 처리 및 신뢰도 향상
#### 문제 상황:
센서 입력에 포함된 노이즈로 인해 거리 측정 값이 불안정하게 튀는 현상 발생

Echo 신호가 일정 시간 내에 수신되지 않거나, 신호의 지속 시간이 과도하게 길어 정상적인 수신 불가

#### 해결 방법:
Median Filter 적용으로 스파이크 제거

Echo 수신 시간에 따른 오류 FSM 분기 및 시뮬레이션 기반 상태 확인

Timeout, 최소 거리, 최대 거리 조건에 따른 예외 처리 FSM 구현

<br>

### [2] 온습도 센서 통신 오류 및 Metastability 문제

#### 문제 상황:
Checksum 오류 다발 발생

타이밍 문제로 인해 수신 실패 빈번

비동기 입력 신호로 인한 Metastability 가능성

#### 원인 분석:
DHT11 통신의 single-wire 특성상 정밀한 타이밍 요구

합성 시 Propagation Delay로 인해 신호 왜곡

비- 동기 신호를 동기 클럭 도메인에서 처리함으로써 Metastability 발생

#### 해결 방법:
FSM 상태 세분화 및 타이밍 조건 재정의

비동기 입력에 대해 1us 엣지 감지 기반으로 리샘플링

자동 측정 FSM 추가하여 10초 주기로 데이터 수집

## 고찰
<details>
<summary> 고찰 </summary>

이번 프로젝트는 다양한 센서와 디지털 논리 회로, UART 기반 통신 시스템을 하나의 디스플레이 모듈로 통합한 실질적인 임베디드 시스템 설계 경험이었다.

특히 단일 기능을 넘어서 버튼 및 UART 입력에 따라 다양한 동작 모드를 구현하는 FSM 구성 능력과, 실시간 센서 데이터 처리 및 디버깅 과정을 통해 하드웨어 설계에 대한 실전 감각을 키울 수 있었다.

또한, 각 기능 간 신호 흐름을 명확히 설계하고, 사용자 명령과 디지털 회로 동작이 연동되도록 통합한 점에서 시스템 아키텍처 설계 경험을 쌓을 수 있었다. 향후 RTOS 기반 시스템이나 파이프라인 구조로의 확장 시에도 본 경험은 중요한 기반이 될 것이다.

</details>